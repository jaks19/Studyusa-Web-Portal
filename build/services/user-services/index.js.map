{"version":3,"sources":["../../../services/user-services/index.js"],"names":["userServices","User","require","notifServices","dbOpsServices","apiServices","getUserData","username","req","res","userData","findOneEntryAndPopulate","populatedUser","allNotifs","notifs","reverse","unseenNotifs","getUnseenNotifs","firstContact","query","welcome","admin","findAllEntriesAndPopulate","users","retrieveNews","articles","subs","submissions","module","exports"],"mappings":";;;;;;;;;;;;AAAA,IAAIA,eAAe,EAAnB;AACA,IAAIC,OAAOC,QAAQ,mBAAR,CAAX;AAAA,IACIC,gBAAgBD,QAAQ,mBAAR,CADpB;AAAA,IAEIE,gBAAgBF,QAAQ,mBAAR,CAFpB;AAAA,IAGIG,cAAcH,QAAQ,iBAAR,CAHlB;;AAKAF,aAAaM,WAAb;AAAA,0EAA2B,iBAA2BC,QAA3B,EAAqCC,GAArC,EAA0CC,GAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AACnBC,gCADmB,GACR,EADQ;AAAA;AAAA,+BAEQN,cAAcO,uBAAd,CAAsCV,IAAtC,EAA4C,EAAC,YAAYM,QAAb,EAA5C,EAAoE,CAAC,aAAD,EAAgB,QAAhB,CAApE,EAA+FC,GAA/F,EAAoGC,GAApG,CAFR;;AAAA;AAEvBC,iCAASE,aAFc;AAGvBF,iCAASG,SAAT,GAAqBH,SAASE,aAAT,CAAuBE,MAAvB,CAA8BC,OAA9B,EAHE;AAIvBL,iCAASM,YAAT,GAAwBb,cAAcc,eAAd,CAA8BP,SAASE,aAAT,CAAuBE,MAArD,CAJD;AAKvBJ,iCAASQ,YAAT,GAAwBV,IAAIW,KAAJ,CAAUC,OAAV,GAAoB,IAApB,GAA2B,KAL5B;;AAAA,6BAMnBV,SAASE,aAAT,CAAuBS,KANJ;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAOIjB,cAAckB,yBAAd,CAAwCrB,IAAxC,EAA8C,EAA9C,EAAmD,EAAnD,EAAwDO,GAAxD,EAA6DC,GAA7D,CAPJ;;AAAA;AAOnBC,iCAASa,KAPU;AAAA;AAAA;;AAAA;AAAA;AAAA,+BASOlB,YAAYmB,YAAZ,CAAyBhB,GAAzB,CATP;;AAAA;AASnBE,iCAASe,QATU;AAUnBf,iCAASgB,IAAT,GAAgBhB,SAASE,aAAT,CAAuBe,WAAvB,CAAmCZ,OAAnC,EAVG;;AAAA;AAAA,yDAYhBL,QAZgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA3B;;AAAA,aAA0CJ,WAA1C;AAAA;AAAA;;AAAA,WAA0CA,WAA1C;AAAA;;AAeAsB,OAAOC,OAAP,GAAiB7B,YAAjB","file":"index.js","sourcesContent":["var userServices = {};\nlet User = require(\"../../models/user\"),\n    notifServices = require('../notif-services'),\n    dbOpsServices = require('../dbops-services'),\n    apiServices = require('../api-services');\n\nuserServices.getUserData = async function getUserData(username, req, res) {\n    var userData = {};\n    userData.populatedUser = await dbOpsServices.findOneEntryAndPopulate(User, {'username': username}, ['submissions', 'notifs'], req, res),\n    userData.allNotifs = userData.populatedUser.notifs.reverse(),\n    userData.unseenNotifs = notifServices.getUnseenNotifs(userData.populatedUser.notifs),\n    userData.firstContact = req.query.welcome ? true : false;\n    if (userData.populatedUser.admin){\n        userData.users = await dbOpsServices.findAllEntriesAndPopulate(User, { }, [ ], req, res);\n    } else {\n        userData.articles = await apiServices.retrieveNews(req),\n        userData.subs = userData.populatedUser.submissions.reverse();\n    }\n    return userData;\n}\n\nmodule.exports = userServices;"]}